

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GPIO Input &mdash; Embedded Tutorials 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=e9d84906" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f281be69"></script>
      <script src="../../_static/custom.js?v=5fde6192"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="GPIO External Interrupt" href="gpio_ext_interrupt.html" />
    <link rel="prev" title="GPIO Output" href="gpio_output.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Embedded Tutorials
              <img src="../../_static/embedded-logo.webp" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../stm32_basics_tutorial.html">STM32 Basics Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../basic_setup.html">Basic Setup</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../gpio.html">GPIO</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="gpio_output.html">GPIO Output</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">GPIO Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="gpio_ext_interrupt.html">GPIO External Interrupt</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usb.html">USB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../swd.html">SWD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../uart.html">UART</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timer.html">Timer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../intermediate_tutorial.html">Intermediate Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../highlights.html">Highlights</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Embedded Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../stm32_basics_tutorial.html">STM32 Basics Tutorial</a></li>
          <li class="breadcrumb-item"><a href="../gpio.html">GPIO</a></li>
      <li class="breadcrumb-item active">GPIO Input</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/Robotics-Club-Pulchowk/EmbeddedTutorials/blob/main/source/stm32_basics_tutorial/gpio/gpio_input.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>This is continued from <a class="reference external" href="gpio_output.html">gpio output</a>.</p>
<section id="gpio-input">
<h1>GPIO Input<a class="headerlink" href="#gpio-input" title="Link to this heading"></a></h1>
<nav class="contents local" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#logic" id="id1">1. Logic</a></p></li>
<li><p><a class="reference internal" href="#cubemx-configuration" id="id2">2. CubeMX Configuration</a></p></li>
<li><p><a class="reference internal" href="#code-to-check-pinstate" id="id3">3. Code to Check PinState</a></p></li>
<li><p><a class="reference internal" href="#observation" id="id4">4. Observation</a></p></li>
<li><p><a class="reference internal" href="#references" id="id5">References</a></p></li>
</ul>
</nav>
<section id="logic">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">1. Logic</a><a class="headerlink" href="#logic" title="Link to this heading"></a></h2>
<p><strong>For 3V3 microcontrollers</strong>:</p>
<ul class="simple">
<li><p>Logic 1 above 1.88V.</p></li>
<li><p>Login 0 below 1.23V.</p></li>
<li><p>Most of them are 5V tolerant.</p></li>
</ul>
<p><strong>For 5V microcontrollers:</strong></p>
<ul class="simple">
<li><p>Logic 1 above 3V</p></li>
<li><p>Logic 0 below 1.5V</p></li>
</ul>
<p>When VCC is appled to input pin, the input state will be high. And when GND is applied to input pin, the input state will be low. But if input pin is disconnected, the input is on floating state and it is hard to predict. So to remove such ambiguity pull-up or pull-down resistors are connected to input pin.</p>
<p>Microcontrollers have internal pull-up/pull-down resistors which can be connectd by programming. We also can connect external pull-up/pull-down resistors. Typical value for pull-up/pull-down resistors are <strong>4.7K</strong> and <strong>10K</strong>.</p>
<a class="reference internal image-reference" href="../../_images/Pull-up-and-Pull-down-Resistor.png"><img alt="Pull-up-and-Pull-down-Resistor" class="align-center" src="../../_images/Pull-up-and-Pull-down-Resistor.png" style="width: 100%;" />
</a>
<p>Pull-up resistor connects the input pin to VCC and pull-down resistor connects the input pin to GND. When input pin is not connected, pull-up resistor connects the input pin to VCC and pull-down resistor connects the input pin to GND. So, the input state will be high and low respectively.</p>
<p>For Open Drain output, pull-up resistor is used. For Open Collector output, pull-down resistor is used. Signals with pull-ups tend to be less sensitive to noise in noisy environments (e.g., industrial environments) because they are biased toward the high state.</p>
</section>
<section id="cubemx-configuration">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">2. CubeMX Configuration</a><a class="headerlink" href="#cubemx-configuration" title="Link to this heading"></a></h2>
<p>To read the input from the GPIO pin, we need to configure the pin as input. Open <code class="docutils literal notranslate"><span class="pre">STM32CubeMX</span></code> to configure the pin as input. Discovery board has a user button on <code class="docutils literal notranslate"><span class="pre">PA0</span></code> pin. To know about this, open <code class="docutils literal notranslate"><span class="pre">STM32F407G-DISC1</span></code> from <code class="docutils literal notranslate"><span class="pre">board</span> <span class="pre">selector</span></code> of STM32CubeMX in default mode or see <a class="extlink-newtab reference external" href="https://www.google.com/url?sa=t&amp;source=web&amp;rct=j&amp;opi=89978449&amp;url=https://www.st.com/resource/en/schematic_pack/mb997-f407vgt6-b02_schematic.pdf&amp;ved=2ahUKEwjdoNq3-byIAxX5zDgGHa-OAX4QFnoECBQQAQ&amp;usg=AOvVaw0S1_y_ksxURXPd02EFhSfS">schematic of Discovery Board</a>. Select pin <code class="docutils literal notranslate"><span class="pre">PA1</span></code> as <code class="docutils literal notranslate"><span class="pre">GPIO_Input</span></code>. Also select pin <code class="docutils literal notranslate"><span class="pre">PA1</span></code> as <code class="docutils literal notranslate"><span class="pre">GPIO_Input</span></code>.</p>
<a class="reference internal image-reference" href="../../_images/gpio_input_select.png"><img alt="gpio_input_select" class="align-center" src="../../_images/gpio_input_select.png" style="width: 100%;" />
</a>
<p>The pin <code class="docutils literal notranslate"><span class="pre">PA0</span></code> is already pulled down on the board, so we do not need to do anything with pin <code class="docutils literal notranslate"><span class="pre">PA0</span></code> but for pin <code class="docutils literal notranslate"><span class="pre">PA1</span></code>, we will pull it up using internal pull-up resistor.</p>
<ul class="simple">
<li><p>From CubeMX <code class="docutils literal notranslate"><span class="pre">Pin</span> <span class="pre">&amp;</span> <span class="pre">Configuration</span></code>, navigate to <code class="docutils literal notranslate"><span class="pre">System</span> <span class="pre">Core</span> <span class="pre">&gt;</span> <span class="pre">GPIO</span></code>.</p></li>
<li><p>Inside <code class="docutils literal notranslate"><span class="pre">GPIO</span> <span class="pre">Mode</span> <span class="pre">and</span> <span class="pre">Configuration</span></code> under <code class="docutils literal notranslate"><span class="pre">GPIO</span></code> tab, select <code class="docutils literal notranslate"><span class="pre">PA1</span></code> from the list. <code class="docutils literal notranslate"><span class="pre">PA1</span> <span class="pre">Configuration</span></code> will be expaned.</p></li>
<li><p>From <code class="docutils literal notranslate"><span class="pre">PA1</span> <span class="pre">Configuration</span></code>, change <code class="docutils literal notranslate"><span class="pre">GPIO</span> <span class="pre">Pull-up/Pull-down</span></code> to <code class="docutils literal notranslate"><span class="pre">Pull-up</span></code>.</p></li>
<li><p>Also set pin <code class="docutils literal notranslate"><span class="pre">PD13</span></code> to <code class="docutils literal notranslate"><span class="pre">GPIO_Output</span></code>.</p></li>
</ul>
<a class="reference internal image-reference" href="../../_images/gpio_input_pull-up.webp"><img alt="gpio_input_pull-up" class="align-center" src="../../_images/gpio_input_pull-up.webp" style="width: 100%;" />
</a>
<p>Now generate code.</p>
</section>
<section id="code-to-check-pinstate">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">3. Code to Check PinState</a><a class="headerlink" href="#code-to-check-pinstate" title="Link to this heading"></a></h2>
<p>Open project folder. Navigate to <code class="docutils literal notranslate"><span class="pre">Core/Src/main.c</span></code>. Update the <code class="docutils literal notranslate"><span class="pre">while</span></code> block.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Infinite loop */</span>
<span class="w">  </span><span class="cm">/* USER CODE BEGIN WHILE */</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Check pin PA0</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HAL_GPIO_ReadPin</span><span class="p">(</span><span class="n">GPIOA</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_PIN_0</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">GPIO_PIN_SET</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// turn on green led on pin PD12.</span>
<span class="w">      </span><span class="n">HAL_GPIO_WritePin</span><span class="p">(</span><span class="n">GPIOD</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_PIN_12</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_PIN_SET</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// turn off green led on pin PD12</span>
<span class="w">      </span><span class="n">HAL_GPIO_WritePin</span><span class="p">(</span><span class="n">GPIOD</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_PIN_12</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_PIN_RESET</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Check pin PA1</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HAL_GPIO_ReadPin</span><span class="p">(</span><span class="n">GPIOA</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_PIN_1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">GPIO_PIN_SET</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// turn on orange led on pin PA13</span>
<span class="w">      </span><span class="n">HAL_GPIO_WritePin</span><span class="p">(</span><span class="n">GPIOD</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_PIN_13</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_PIN_RESET</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// turn off orange led on pin PA13</span>
<span class="w">      </span><span class="n">HAL_GPIO_WritePin</span><span class="p">(</span><span class="n">GPIOD</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_PIN_13</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_PIN_SET</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="cm">/* USER CODE END WHILE */</span>

<span class="w">    </span><span class="cm">/* USER CODE BEGIN 3 */</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="cm">/* USER CODE END 3 */</span>
</pre></div>
</div>
<p>It is easy to understand this code.</p>
<ul class="simple">
<li><p>If pin <code class="docutils literal notranslate"><span class="pre">PA0</span></code> is set high i.e. user button is pressed, green led turns on else off.</p></li>
<li><p>If pin <code class="docutils literal notranslate"><span class="pre">PA1</span></code> is set high i.e. pin <code class="docutils literal notranslate"><span class="pre">PA1</span></code> connected to VCC, orange led turns on else off.</p></li>
</ul>
<p>Pin <code class="docutils literal notranslate"><span class="pre">PA0</span></code> is pulled low on the board, so not pressing user buttons connects pin <code class="docutils literal notranslate"><span class="pre">PA0</span></code> to GND. Pin <code class="docutils literal notranslate"><span class="pre">PA1</span></code> is pulled high, so not connecting anything to pin <code class="docutils literal notranslate"><span class="pre">PA1</span></code> sets pin <code class="docutils literal notranslate"><span class="pre">PA1</span></code> high.</p>
<p>Build and flash the code to controller.</p>
</section>
<section id="observation">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">4. Observation</a><a class="headerlink" href="#observation" title="Link to this heading"></a></h2>
<p>You can use a jumper to connect pin <code class="docutils literal notranslate"><span class="pre">PA1</span></code> to connect to GND or 3V3.</p>
<ul class="simple">
<li><p>Green led turns on only if user button is pressed.</p></li>
<li><p>Orange led turns off only if pin <code class="docutils literal notranslate"><span class="pre">PA1</span></code> is connected to GND.</p></li>
</ul>
<p>Next, we will see how to use external interrupt to read the input pin.</p>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">References</a><a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<p>References are from <code class="docutils literal notranslate"><span class="pre">STM32</span> <span class="pre">HAL</span> <span class="pre">Driver</span></code> documentation.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.HAL_GPIO_ReadPin">
<span class="n"><span class="pre">GPIO_PinState</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">HAL_GPIO_ReadPin</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">GPIO_TypeDef</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">GPIOx</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">GPIO_Pin</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.HAL_GPIO_ReadPin" title="Link to this definition"></a><br /></dt>
<dd><p>Reads the specified input port pin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GPIOx</strong> (<span><span class="c-expr sig sig-inline c"><span class="n">GPIO_TypeDef</span><span class="p">*</span></span></span>) – Specifies the GPIO peripheral.
- For STM32F429X devices: A..K
- For STM32F40XX and STM32F427X devices: A..I</p></li>
<li><p><strong>GPIO_Pin</strong> (<span><span class="c-expr sig sig-inline c"><span class="n">uint16_t</span></span></span>) – Specifies the port bit to read. This parameter can be <code class="docutils literal notranslate"><span class="pre">GPIO_PIN_x</span></code> where x can be (0..15).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The input port pin value (GPIO_PIN_SET or GPIO_PIN_RESET).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>GPIO_PinState</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gpio_output.html" class="btn btn-neutral float-left" title="GPIO Output" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gpio_ext_interrupt.html" class="btn btn-neutral float-right" title="GPIO External Interrupt" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Robotics Club, Pulchowk Campus.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>